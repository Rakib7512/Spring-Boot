<div class="container mt-4">
  <h3 class="mb-3">Add New Parcel</h3>

  <div class="row">
    <!-- Sender Info -->
    <div class="col-md-6">
      <label>Sender Name</label>
      <input [(ngModel)]="senderName" name="senderName" class="form-control" required>

      <label>Sender Phone</label>
      <input [(ngModel)]="senderPhone" name="senderPhone" class="form-control" required>

      <select class="form-select mt-2" [(ngModel)]="selectedSendCountry" (change)="onSendCountryChange()">
        <option value="">-- Select Country --</option>
        <option *ngFor="let c of countries" [value]="c.id">{{ c.name }}</option>
      </select>

      <select class="form-select mt-2" [(ngModel)]="selectedSendDivision" (change)="onSendDivisionChange()">
        <option value="">-- Select Division --</option>
        <option *ngFor="let d of divisions" [value]="d.id">{{ d.name }}</option>
      </select>

      <select class="form-select mt-2" [(ngModel)]="selectedSendDistrict" (change)="onSendDistrictChange()">
        <option value="">-- Select District --</option>
        <option *ngFor="let d of districts" [value]="d.id">{{ d.name }}</option>
      </select>

      <select class="form-select mt-2" [(ngModel)]="selectedSendPoliceStation">
        <option value="">-- Select Police Station --</option>
        <option *ngFor="let ps of policeStations" [value]="ps.id">{{ ps.name }}</option>
      </select>

      <div class="mt-3">
        <label>Address Line 1</label>
        <input type="text" class="form-control" [(ngModel)]="addressLineForSender1">

        <label class="mt-2">Address Line 2</label>
        <input type="text" class="form-control" [(ngModel)]="addressLineForSender2">
      </div>
    </div>

    <!-- Receiver Info -->
    <div class="col-md-6">
      <label>Receiver Name</label>
      <input [(ngModel)]="receiverName" name="receiverName" class="form-control" required>

      <label>Receiver Phone</label>
      <input [(ngModel)]="receiverPhone" name="receiverPhone" class="form-control" required>

      <select class="form-select mt-2" [(ngModel)]="selectedReceiveCountry" (change)="onReceiveCountryChange()">
        <option value="">-- Select Country --</option>
        <option *ngFor="let c of receiverCountries" [value]="c.id">{{ c.name }}</option>
      </select>

      <select class="form-select mt-2" [(ngModel)]="selectedReceiveDivision" (change)="onReceiveDivisionChange()">
        <option value="">-- Select Division --</option>
        <option *ngFor="let d of receiverDivisions" [value]="d.id">{{ d.name }}</option>
      </select>

      <select class="form-select mt-2" [(ngModel)]="selectedReceiveDistrict" (change)="onReceiveDistrictChange()">
        <option value="">-- Select District --</option>
        <option *ngFor="let d of receiverDistricts" [value]="d.id">{{ d.name }}</option>
      </select>

      <select class="form-select mt-2" [(ngModel)]="selectedReceivePoliceStation">
        <option value="">-- Select Police Station --</option>
        <option *ngFor="let ps of receiverPoliceStations" [value]="ps.id">{{ ps.name }}</option>
      </select>

      <div class="mt-3">
        <label>Address Line 1</label>
        <input type="text" class="form-control" [(ngModel)]="addressLineForReceiver1">

        <label class="mt-2">Address Line 2</label>
        <input type="text" class="form-control" [(ngModel)]="addressLineForReceiver2">
      </div>
    </div>
  </div>

  <!-- Parcel Details -->
  <div class="card shadow-sm p-3 mb-3 mt-3">
    <h5 class="mb-3 text-info">Parcel Details</h5>

    <div class="row g-3">
      <div class="col-md-6">
        <label>Parcel Size</label>
        <select [(ngModel)]="size" name="size" class="form-select" (change)="calculateParcelFee()" required>
          <option value="">-- Select Size --</option>
          <option value="SMALL">Small</option>
          <option value="MEDIUM">Medium</option>
          <option value="LARGE">Large</option>
          <option value="EXTRA_LARGE">Extra Large</option>
        </select>
      </div>

      <div class="col-md-6">
        <label>Parcel Fee (à§³)</label>
        <input type="number" [(ngModel)]="fee" name="fee" class="form-control" readonly>
      </div>
    </div>

    <div class="form-group mt-3">
      <label for="paymentMethod">Payment Method</label>
      <select class="form-control" id="paymentMethod" [(ngModel)]="paymentMethod" (change)="updatePaymentDetails()">
        <option value="">Select Payment Method</option>
        <option value="bkash">Bkash</option>
        <option value="nagad">Nagad</option>
        <option value="bank">Bank</option>
      </select>
    </div>

    <div class="mt-2" *ngIf="paymentInfo">
      <div class="alert alert-info">
        {{ paymentInfo }}
      </div>
    </div>

    <button class="btn btn-primary mt-2" (click)="startPayment()">ðŸ’° Proceed to Payment</button>

    <div class="alert alert-warning mt-2" *ngIf="trackingId && paymentSuccess">
      ðŸ“¦ Your Parcel Tracking ID: <strong>{{ trackingId }}</strong><br />
      Please include this ID when making your payment.
    </div>

    <div class="mt-3" *ngIf="paymentSuccess">
      <label>Enter Payment Confirmation Code:</label>
      <input type="text" class="form-control" [(ngModel)]="enteredConfirmationCode" placeholder="Enter confirmation code">
    </div>
  </div>

  <button type="button" class="btn btn-success mt-3" (click)="submitParcel()">Submit Parcel</button>
</div>
